<% title t('.page_title') %>
<div class="moj-page-header-actions">
  <div class="moj-page-header-actions__title">
      <h1 class="govuk-heading-xl">
          <%= t('.page_title') %>
      </h1>
  </div>

  <div class="moj-page-header-actions__actions">
    <div class="moj-button-group moj-button-group--inline">
        <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button">
            <%= t('.add_new_user') %>
        </button>
    </div>
  </div>
</div>

<table class="govuk-table" data-module="moj-sortable-table" aria-describedby="page-title">
    <thead class="govuk-table__head">
        <tr class="govuk-table__row">
            <%= table_header_with_form("name",
                                       "users.index.table",
                                       0,
                                       users_path,
                                       @sort_by,
                                       @sort_direction) %>


            <%= table_header_with_form("email",
                                       "users.index.table",
                                       1,
                                       users_path,
                                       @sort_by,
                                       @sort_direction) %>


            <%= table_header_with_form("role",
                                       "users.index.table",
                                       2,
                                       users_path,
                                       @sort_by,
                                       @sort_direction) %>
        </tr>
    </thead>

    <tbody class="govuk-table__body app-task-list__items">
        <% users.each do |user| %>
            <tr class="govuk-table__row app-task-list__item">
                <td class="govuk-table__cell">
                    <%= user.first_name %> <%= user.last_name %>
                </td>
                <td class="govuk-table__cell">
                    <%= user.email %>
                </td>
                <td class="govuk-table__cell">
                    <%= user.roles.pluck(:role_type).join(',') %>
                </td>
            </tr>
        <% end %>
    </tbody>
</table>
<%= render 'shared/pagination', pagy: pagy, item: t(".users") %>
